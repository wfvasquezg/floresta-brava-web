<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Floresta Brava | Comida típica ecuatoriana</title>
  <meta name="description" content="Floresta Brava: comida típica ecuatoriana en Quito. Menú diario (lunes a sábado) y menú especial los domingos." />

  <style>
    :root {
      --madera: #7a4b1f;
      --madera-oscura: #4b2a12;
      --turquesa: #1fb6c9;
      --naranja: #f57c22;
      --crema: #fff7e8;
      --gris: #444;
      --verde: #145b6b;
      --verde-oscuro: #0b2731;
      --amarillo: var(--naranja);
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; line-height: 1.5; color: #222; background: #f5f3ee; }
    a { text-decoration: none; }

    header {
      position: sticky; top: 0; z-index: 100;
      background: linear-gradient(90deg, var(--madera-oscura), var(--verde));
      backdrop-filter: blur(6px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.25);
    }
    .container { max-width: 1120px; margin: 0 auto; padding: 0 16px; }
    .nav { display: flex; align-items: center; justify-content: space-between; height: 68px; }
    .logo-area { display: flex; align-items: center; gap: 10px; }
    .logo-img { height: 40px; width: auto; }
    nav ul { list-style: none; display: flex; gap: 16px; }
    nav a { color: #f4f4f4; font-size: 14px; }
    nav a:hover { color: var(--amarillo); }

    /* En vez de ocultar TODO el menú por CSS, solo ocultamos el bloque especial.
       Así si falla JS, igual se ve el menú base. */
    #especial-domingo { display: none; }

    .hero {
      position: relative; min-height: 80vh;
      display: flex; align-items: center;
      color: #fff; background: #000; overflow: hidden;
    }
    .hero::before {
      content: ""; position: absolute; inset: 0;
      background: linear-gradient(120deg, rgba(10,39,49,0.95), rgba(122,75,31,0.65));
      z-index: 1;
    }
    .hero img.bg {
      position: absolute; inset: 0;
      width: 100%; height: 100%;
      object-fit: cover;
      filter: brightness(.8);
    }
    .hero-content { position: relative; z-index: 2; padding: 40px 16px 40px; }
    .hero-kicker { font-size: 13px; letter-spacing: .18em; text-transform: uppercase; color: #ffe6c0; margin-bottom: 8px; }
    .hero h1 { font-size: 32px; max-width: 520px; margin-bottom: 12px; }
    .hero p { max-width: 480px; font-size: 15px; color: #fbeee0; margin-bottom: 20px; }
    .hero-badges { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 24px; font-size: 12px; }

    .badge {
      padding: 4px 10px; border-radius: 999px;
      background: rgba(0,0,0,0.25);
      border: 1px solid rgba(255,255,255,0.3);
      color: #fff;
    }
    .btn {
      display: inline-flex; align-items: center; justify-content: center;
      padding: 12px 22px; border-radius: 999px;
      font-weight: 600; font-size: 14px;
      border: none; cursor: pointer;
      transition: transform .1s ease, box-shadow .15s ease, background .15s ease;
    }
    .btn-primary { background: #22c15d; color: #fff; box-shadow: 0 10px 20px rgba(0,0,0,0.35); }
    .btn-primary:hover { transform: translateY(-1px); box-shadow: 0 14px 26px rgba(0,0,0,0.4); background: #1ea652; }
    .btn-ghost { background: transparent; color: #fff; border: 1px solid rgba(255,255,255,0.7); margin-left: 10px; }
    .btn-group { display: flex; flex-wrap: wrap; gap: 8px; }

    .section { padding: 56px 0; }
    .section.alt { background: #ffffff; }
    .section.soft { background: var(--crema); }
    .section-title { font-size: 24px; text-align: center; margin-bottom: 8px; color: var(--madera-oscura); }
    .section-subtitle { font-size: 14px; text-align: center; max-width: 560px; margin: 0 auto 28px; color: #555; }
    .grid { display: grid; gap: 16px; }

    .hero-logo { margin-bottom: 24px; text-align: center; }
    .hero-logo img { height: 180px; width: auto; filter: drop-shadow(0 10px 18px rgba(0,0,0,0.55)); }

    @media (min-width: 768px) {
      .hero-logo img { height: 240px; }
      .hero h1 { font-size: 40px; }
      .grid-3 { grid-template-columns: repeat(3, 1fr); }
      .grid-2 { grid-template-columns: repeat(2, 1fr); }
      .hero-content { padding-top: 56px; }
    }

    .card {
      background: #fff; border-radius: 14px; padding: 16px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.06);
      border: 1px solid rgba(0,0,0,0.03);
    }
    .card img { width: 100%; border-radius: 12px; margin-bottom: 10px; display: block; }
    .card h3 { font-size: 16px; margin-bottom: 4px; color: var(--madera-oscura); }
    .card p { font-size: 13px; color: #555; }
    .price { font-weight: 700; color: var(--verde-oscuro); margin-top: 6px; font-size: 14px; }
    .pill { display: inline-block; font-size: 11px; padding: 3px 8px; border-radius: 999px; background: rgba(31,182,201,0.09); color: var(--verde-oscuro); margin-top: 4px; }

    .highlight {
      background: #fff; border-radius: 14px; padding: 16px;
      border-left: 4px solid var(--madera);
      box-shadow: 0 6px 18px rgba(0,0,0,0.04);
      margin-bottom: 16px;
    }
    .highlight h3 { font-size: 16px; margin-bottom: 4px; color: var(--madera-oscura); }
    .highlight p { font-size: 13px; color: #555; }

    .map { border-radius: 16px; overflow: hidden; box-shadow: 0 8px 22px rgba(0,0,0,0.09); }
    .map iframe { width: 100%; height: 320px; border: 0; }

    .section-menudiario .menudiario-top {
      display: grid;
      grid-template-columns: minmax(0, 1.2fr) minmax(0, 1fr);
      max-width: 900px;
      margin: 24px auto 0;
      align-items: flex-start;
      gap: 40px;
    }
    .menudiario-img { margin-top: 8px; }
    .menudiario-img img{
      width: 100%;
      max-width: 420px;
      height: auto;
      display: block;
      margin-left: auto;
      object-fit: contain;
      object-position: center;
    }
    .menudiario-caption { font-size: 12px; color: #777; margin-top: 6px; text-align: right; }
    .menudiario-horario { max-width: 900px; margin: 32px auto 0; font-size: 14px; color: #555; }
    .menudiario-horario h3 { font-size: 16px; margin-bottom: 6px; color: var(--madera-oscura); }
    .menudiario-horario ul { margin-left: 18px; margin-bottom: 8px; }

    @media (max-width: 767px) {
      .section-menudiario .menudiario-top { max-width: 100%; margin-top: 16px; gap: 20px; grid-template-columns: 1fr; }
      .menudiario-img img { max-width: 100%; margin-left: 0; }
      .menudiario-caption { text-align: left; }
    }

    footer {
      background: var(--madera-oscura);
      color: #eee;
      padding: 24px 0;
      font-size: 13px;
      border-top: 3px solid var(--naranja);
    }
    .footer-inner { display: flex; flex-direction: column; gap: 8px; }
    .social a { color: #eee; margin-right: 12px; }
    .social a:hover { color: var(--turquesa); }
    @media (min-width: 640px) {
      .footer-inner { flex-direction: row; justify-content: space-between; align-items: center; }
    }

    .skip-link {
      position: absolute; left: -999px; top: 8px;
      background: #fff; color: #000;
      padding: 10px 14px; border-radius: 10px;
      z-index: 9999; box-shadow: 0 6px 18px rgba(0,0,0,.2);
    }
    .skip-link:focus { left: 12px; }

    .nav-toggle {
      display: none;
      align-items: center; justify-content: center; gap: 6px;
      background: rgba(255,255,255,.12);
      border: 1px solid rgba(255,255,255,.18);
      border-radius: 14px; padding: 10px 12px;
      cursor: pointer; color: #fff;
      backdrop-filter: blur(6px);
    }
    .nav-toggle:focus { outline: 2px solid rgba(255,255,255,.5); outline-offset: 2px; }
    .nav-toggle-bar { display: block; width: 22px; height: 2px; background: #fff; border-radius: 2px; }
    .nav-menu ul { margin: 0; padding: 0; list-style: none; }

    @media (max-width: 768px) {
      .nav-toggle { display: inline-flex; }
      .nav-menu ul {
        display: none;
        position: absolute;
        right: 16px;
        top: 64px;
        width: min(320px, calc(100vw - 32px));
        background: rgba(10,10,10,.88);
        border: 1px solid rgba(255,255,255,.14);
        border-radius: 16px;
        padding: 10px;
        box-shadow: 0 18px 40px rgba(0,0,0,.35);
        backdrop-filter: blur(10px);
      }
      .nav-menu.open ul { display: block; }
      .nav-menu li a { display: block; padding: 12px 14px; border-radius: 12px; }
      .nav-menu li a:hover { background: rgba(255,255,255,.10); }
    }

    .floating-ctas {
      position: fixed;
      right: 16px;
      bottom: 16px;
      display: grid;
      gap: 10px;
      z-index: 999;
    }
    .fab {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 12px 14px;
      border-radius: 999px;
      color: #fff;
      font-weight: 700;
      box-shadow: 0 14px 30px rgba(0,0,0,.25);
      border: 1px solid rgba(255,255,255,.14);
      backdrop-filter: blur(10px);
    }
    .fab svg { width: 20px; height: 20px; fill: currentColor; }
    .fab-whatsapp { background: #1faa59; }
    .fab-maps { background: rgba(0,0,0,.55); }
    @media (max-width: 480px) {
      .fab span { display: none; }
      .fab { padding: 12px; border-radius: 16px; }
    }

    .menu-hoy-grid{
      display:grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap:16px;
      margin-top:18px;
    }
    .menu-hoy-col{
      background:#fff;
      border:1px solid rgba(0,0,0,.06);
      border-radius:16px;
      padding:16px 16px 14px;
      box-shadow:0 10px 30px rgba(0,0,0,.06);
      text-align:center;
    }
    .menu-hoy-col h3{ margin:0 0 10px 0; }
    @media (max-width: 920px){ .menu-hoy-grid{ grid-template-columns: 1fr; } }

    #platos{ padding-top: 18px; }

    .finsemana-opciones { grid-template-columns: repeat(2, minmax(0, 1fr)); max-width: 860px; margin-left: auto; margin-right: auto; }
    @media (max-width: 920px){ .finsemana-opciones{ grid-template-columns: 1fr; } }
  </style>
</head>

<body>
  <a class="skip-link" href="#contenido">Saltar al contenido</a>

  <header>
    <div class="container">
      <div class="nav">
        <div class="logo-area">
          <img class="logo-img" src="img/logoflorestatransparente.png" alt="Floresta Brava" loading="eager" decoding="async" />
          <strong style="color:#fff; letter-spacing:.06em;">FLORESTA BRAVA</strong>
        </div>

        <button class="nav-toggle" type="button" aria-label="Abrir menú" aria-expanded="false">
          <span class="nav-toggle-bar"></span>
          <span class="nav-toggle-bar"></span>
          <span class="nav-toggle-bar"></span>
        </button>

        <nav class="nav-menu" aria-label="Navegación principal">
          <ul>
            <li><a href="#platos">Menú</a></li>
            <li><a href="#platos">Platos estrella</a></li>
            <li><a href="#menudiario">Menú diario</a></li>
            <li><a href="#menudiario">Domingo especial</a></li>
            <li><a href="#empresas">Empresas</a></li>
            <li><a href="#ubicacion">Ubicación</a></li>
            <li><a href="#resenas">Reseñas</a></li>
            <li><a href="#faq">FAQ</a></li>
            <li><a href="#contacto">Contacto</a></li>
          </ul>
        </nav>
      </div>
    </div>
  </header>

  <main id="contenido">
    <!-- HERO -->
    <section class="hero">
      <img class="bg" src="img/fondo_menu.jpg" alt="" loading="eager" decoding="async" />
      <div class="container hero-content">
        <div class="hero-logo">
          <img src="img/logoflorestatransparente.png" alt="Floresta Brava" loading="eager" decoding="async" />
        </div>
        <div class="hero-kicker">Comida típica ecuatoriana</div>
        <h1>La excelencia del sabor, <br/>todos los días en Quito</h1>
        <p>Menú diario (lunes a sábado) y menú especial los domingos. Pide por WhatsApp o visítanos en Av. Coruña y Guipúzcoa.</p>
        <div class="hero-badges">
          <span class="badge">Menú diario</span>
          <span class="badge">Domingo especial</span>
          <span class="badge">Pedidos por WhatsApp</span>
        </div>
        <div class="btn-group">
          <a class="btn btn-primary" href="https://wa.me/593983603626" target="_blank" rel="noopener">Pedir por WhatsApp</a>
          <a class="btn btn-ghost" href="#menudiario">Ver menú</a>
        </div>
      </div>
    </section>

    <!-- PLATOS (placeholder) -->
    <section id="platos" class="section alt">
      <div class="container">
        <h2 class="section-title">Platos estrella</h2>
        <p class="section-subtitle">Algunos favoritos de nuestros clientes.</p>
        <div class="grid grid-3">
          <div class="card">
            <img src="img/plato1.jpg" alt="Plato estrella 1" loading="lazy" decoding="async">
            <h3>Plato estrella</h3>
            <p>Delicioso y recomendado.</p>
          </div>
          <div class="card">
            <img src="img/plato2.jpg" alt="Plato estrella 2" loading="lazy" decoding="async">
            <h3>Plato estrella</h3>
            <p>Sabores auténticos.</p>
          </div>
          <div class="card">
            <img src="img/plato3.jpg" alt="Plato estrella 3" loading="lazy" decoding="async">
            <h3>Plato estrella</h3>
            <p>Ideal para compartir.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- MENÚ (UN SOLO BLOQUE) -->
    <section id="menudiario" class="section soft section-menudiario">
      <div class="container">
        <h2 id="menudiario-title" class="section-title">Menú diario</h2>
        <p id="menudiario-subtitle" class="section-subtitle">
          Todos los días tenemos un menú diferente con sopa, plato fuerte y bebida. Ideal para almuerzos ejecutivos y en familia.
        </p>

        <div class="menudiario-top">
          <div>
            <div class="highlight">
              <h3>Desayunos típicos</h3>
              <p>Bolón, tigrillo, tamales, corviches, desayunos continentales, desayunos costeños, café pasado y más opciones para empezar bien la mañana.</p>
            </div>

            <div class="highlight">
              <h3>Almuerzo ejecutivo</h3>
              <p>Sopa del día, plato fuerte a elegir y jugo natural.</p>
            </div>

            <div id="menu-hoy" class="highlight">
              <h3 id="menu-hoy-title">Menú de hoy</h3>
              <p><strong>Sopa:</strong> <span id="menu-sopa">Consulta por WhatsApp</span></p>
              <p><strong>Segundos:</strong> <span id="menu-segundos">3 opciones disponibles</span></p>
              <p><strong>Precio:</strong> <span id="menu-precio">$2.75</span></p>
              <p><strong>Bebida:</strong> <span id="menu-bebida">Limonada</span></p>
              <a class="btn btn-primary" href="https://wa.me/593983603626" target="_blank" rel="noopener">Pedir menú de hoy</a>
            </div>
          </div>

          <div class="menudiario-img">
            <img id="menu-hoy-poster" src="img/menu_default.jpg" alt="Afiche del menú" loading="lazy" decoding="async" />
            <div class="menudiario-caption" id="menudiario-caption">Afiche actualizado automáticamente</div>
          </div>
        </div>

        <!-- DOMINGO ESPECIAL (se muestra solo si hoy es domingo y el CSV está activo) -->
        <div id="especial-domingo" class="card" style="max-width:900px;margin:18px auto 0;">
          <h3 id="especial-titulo" style="margin-bottom:10px; color: var(--madera-oscura);">Opciones del domingo</h3>
          <div id="especial-opciones" class="menu-hoy-grid finsemana-opciones"></div>
          <div style="text-align:center; margin-top:14px;">
            <a id="especial-wa" class="btn btn-primary" href="https://wa.me/593983603626" target="_blank" rel="noopener">Reservar por WhatsApp</a>
          </div>
        </div>

        <div class="menudiario-horario">
          <h3>Horarios</h3>
          <ul>
            <li><strong>Lunes a sábado:</strong> Menú diario</li>
            <li><strong>Domingo:</strong> Menú especial (si está activo)</li>
          </ul>
          <p>Dirección: Av. Coruña y Guipúzcoa, Quito.</p>
        </div>
      </div>
    </section>

    <!-- EMPRESAS (placeholder) -->
    <section id="empresas" class="section alt">
      <div class="container">
        <h2 class="section-title">Empresas</h2>
        <p class="section-subtitle">Opciones para grupos y pedidos corporativos.</p>
        <div class="grid grid-2">
          <div class="card">
            <h3>Pedidos para oficinas</h3>
            <p>Coordina con nosotros por WhatsApp y armamos la mejor opción.</p>
          </div>
          <div class="card">
            <h3>Eventos</h3>
            <p>Atendemos reuniones y eventos con menú a la medida.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- UBICACIÓN -->
    <section id="ubicacion" class="section soft">
      <div class="container">
        <h2 class="section-title">Ubicación</h2>
        <p class="section-subtitle">Av. Coruña y Guipúzcoa, Quito</p>
        <div class="map">
          <iframe
            loading="lazy"
            referrerpolicy="no-referrer-when-downgrade"
            src="https://www.google.com/maps?q=Av.%20Coru%C3%B1a%20y%20Guip%C3%BAzcoa%20Quito&output=embed">
          </iframe>
        </div>
      </div>
    </section>

    <!-- RESEÑAS (placeholder) -->
    <section id="resenas" class="section alt">
      <div class="container">
        <h2 class="section-title">Reseñas</h2>
        <p class="section-subtitle">Lo que dicen nuestros clientes.</p>
        <div class="grid grid-3">
          <div class="card"><p>“Excelente sabor y atención.”</p></div>
          <div class="card"><p>“El menú del día siempre sorprende.”</p></div>
          <div class="card"><p>“Volvemos cada semana.”</p></div>
        </div>
      </div>
    </section>

    <!-- FAQ (placeholder) -->
    <section id="faq" class="section soft">
      <div class="container">
        <h2 class="section-title">FAQ</h2>
        <p class="section-subtitle">Preguntas frecuentes</p>
        <div class="grid">
          <div class="card">
            <h3>¿Cómo pido por WhatsApp?</h3>
            <p>Haz clic en “Pedir” y te llevamos directo al chat con el mensaje listo.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- CONTACTO -->
    <section id="contacto" class="section alt">
      <div class="container">
        <h2 class="section-title">Contacto</h2>
        <p class="section-subtitle">Escríbenos y te respondemos rápido.</p>
        <div class="card">
          <p><strong>WhatsApp:</strong> +593 98 360 3626</p>
          <p><strong>Web:</strong> florestabrava.com</p>
        </div>
      </div>
    </section>

    <!-- Floating CTAs -->
    <div class="floating-ctas" aria-label="Accesos rápidos">
      <a class="fab fab-whatsapp" href="https://wa.me/593983603626" target="_blank" rel="noopener">
        <svg viewBox="0 0 32 32" aria-hidden="true"><path d="M16 3C9.4 3 4 8.2 4 14.7c0 2.3.7 4.5 1.9 6.4L4 29l8.1-1.9c1.8 1 3.9 1.6 6 1.6 6.6 0 12-5.2 12-11.7C30 8.2 22.6 3 16 3zm6.9 16.4c-.3.9-1.6 1.7-2.2 1.8-.6.1-1.3.2-2.1-.1-.5-.2-1.2-.4-2-.8-3.6-1.6-6-5.6-6.2-5.9-.2-.3-1.5-2-1.5-3.8 0-1.8.9-2.7 1.2-3.1.3-.3.7-.4.9-.4h.7c.2 0 .5-.1.8.6.3.7 1.1 2.7 1.2 2.9.1.2.1.5 0 .7-.1.2-.2.5-.4.7-.2.2-.4.5-.6.6-.2.2-.4.4-.2.8.2.3.9 1.6 1.9 2.6 1.3 1.2 2.4 1.6 2.8 1.8.3.2.6.1.8-.1.3-.3.9-1.1 1.1-1.5.2-.4.5-.3.8-.2.3.1 2.2 1 2.6 1.2.4.2.6.3.7.5.1.2.1.9-.2 1.8z"/></svg>
        <span>Pedir</span>
      </a>
      <a class="fab fab-maps" href="#ubicacion">
        <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 2C8.1 2 5 5.1 5 9c0 5.3 7 13 7 13s7-7.7 7-13c0-3.9-3.1-7-7-7zm0 9.5c-1.4 0-2.5-1.1-2.5-2.5S10.6 6.5 12 6.5s2.5 1.1 2.5 2.5S13.4 11.5 12 11.5z"/></svg>
        <span>Ubicación</span>
      </a>
    </div>
  </main>

  <footer>
    <div class="container footer-inner">
      <div>© <span id="year"></span> Floresta Brava</div>
      <div class="social">
        <a href="#" aria-label="Instagram">Instagram</a>
        <a href="#" aria-label="Facebook">Facebook</a>
        <a href="#" aria-label="TikTok">TikTok</a>
      </div>
    </div>
  </footer>

  <script defer>
    // =========================
    // Config
    // =========================
    const MENU_HOY_CSV_URL = 'data/menu_hoy.csv';
    const DOMINGO_CSV_URL  = 'data/fin_de_semana.csv'; // lo usamos como “domingo especial”
    const WA_NUMBER = '593983603626';

    // =========================
    // Helpers
    // =========================
    function setText(id, txt) {
      const el = document.getElementById(id);
      if (el) el.textContent = txt ?? '';
    }

    function normalizePrice(v) {
      const s = (v ?? '').toString().trim();
      if (!s) return '';
      if (s.startsWith('$')) return s;
      return '$' + s;
    }

    function todayYMD() {
      // Fecha local del navegador (en Ecuador está bien). Formato YYYY-MM-DD
      const d = new Date();
      const y = d.getFullYear();
      const m = String(d.getMonth() + 1).padStart(2, '0');
      const day = String(d.getDate()).padStart(2, '0');
      return `${y}-${m}-${day}`;
    }

    function isSunday() {
      return new Date().getDay() === 0; // 0 = domingo
    }

    function inRange(ymd, from, to) {
      // Comparación lexicográfica funciona con YYYY-MM-DD
      return ymd >= from && ymd <= to;
    }

    function cacheBust(url, ymd) {
      if (!url) return '';
      const u = url.toString().trim();
      if (!u) return '';
      const sep = u.includes('?') ? '&' : '?';
      return u + sep + 'v=' + encodeURIComponent(ymd);
    }

    function setImg(id, url, ymd, fallback) {
      const img = document.getElementById(id);
      if (!img) return;
      const finalUrl = url && url.toString().trim() ? url.toString().trim() : (fallback || img.getAttribute('src') || '');
      if (!finalUrl) return;
      img.src = cacheBust(finalUrl, ymd);
      img.loading = img.loading || 'lazy';
      img.decoding = img.decoding || 'async';
    }

    async function loadCSV(url) {
      // CSV simple: primera fila header
      const res = await fetch(cacheBust(url, todayYMD()), { cache: 'no-store' });
      if (!res.ok) throw new Error('No se pudo cargar CSV: ' + url);
      const text = await res.text();
      const lines = text.split(/\r?\n/).map(l => l.trim()).filter(Boolean);
      if (lines.length < 2) return [];
      const headers = lines[0].split(',').map(h => h.trim());
      const rows = [];
      for (let i = 1; i < lines.length; i++) {
        const cols = lines[i].split(',').map(c => c.trim());
        const obj = {};
        headers.forEach((h, idx) => obj[h] = cols[idx] ?? '');
        rows.push(obj);
      }
      return rows;
    }

    function waLink(message) {
      return 'https://wa.me/' + WA_NUMBER + '?text=' + encodeURIComponent(message);
    }

    // =========================
    // Main init
    // =========================
    (async function initMenus() {
      const today = todayYMD();

      // Año footer
      const yearEl = document.getElementById('year');
      if (yearEl) yearEl.textContent = new Date().getFullYear();

      // Mobile nav
      const toggle = document.querySelector('.nav-toggle');
      const navMenu = document.querySelector('.nav-menu');
      if (toggle && navMenu) {
        toggle.addEventListener('click', () => {
          const open = navMenu.classList.toggle('open');
          toggle.setAttribute('aria-expanded', open ? 'true' : 'false');
        });
      }

      const especialBox = document.getElementById('especial-domingo');

      async function applyDaily() {
        if (especialBox) especialBox.style.display = 'none';

        setText('menudiario-title', 'Menú diario');
        setText('menudiario-subtitle', 'Todos los días tenemos un menú diferente con sopa, plato fuerte y bebida. Ideal para almuerzos ejecutivos y en familia.');
        setText('menu-hoy-title', 'Menú de hoy');
        setText('menudiario-caption', 'Afiche actualizado automáticamente');

        try {
          const rows = await loadCSV(MENU_HOY_CSV_URL);
          if (!rows.length) return;

          const m = rows[0] || {};
          setText('menu-precio', normalizePrice(m.price) || '$2.75');

          const sopas = (m.sopas || '').toString().split('|').map(s => s.trim()).filter(Boolean);
          const platos = (m.platos_fuertes || '').toString().split('|').map(s => s.trim()).filter(Boolean);

          setText('menu-sopa', sopas.length ? sopas.join(' / ') : 'Consulta por WhatsApp');
          setText('menu-segundos', platos.length ? platos.join(' / ') : '3 opciones disponibles');
          setText('menu-bebida', (m.bebida || 'Limonada').toString().trim() || 'Limonada');

          setImg('menu-hoy-poster', m.poster_url, today, 'img/menu_default.jpg');

          const waBtn = document.querySelector('#menu-hoy a.btn.btn-primary');
          if (waBtn) waBtn.href = waLink('Hola, vengo del menú de hoy de Floresta Brava. Quiero pedir: ');
        } catch (e) {
          console.warn('MENU_HOY:', e);
        }
      }

      async function applySundaySpecial() {
        // Por defecto: oculto hasta validar
        if (especialBox) especialBox.style.display = 'none';

        try {
          const rows = await loadCSV(DOMINGO_CSV_URL);
          if (!rows.length) {
            await applyDaily();
            return;
          }

          const from = (rows[0].active_from || '').toString().trim();
          const to   = (rows[0].active_to || '').toString().trim();

          // Si no hay rango, no lo activamos (para evitar cruces)
          if (!from || !to || !inRange(today, from, to)) {
            await applyDaily();
            return;
          }

          // Activar modo domingo especial
          setText('menudiario-title', 'Menú especial de domingo');
          setText('menudiario-subtitle', 'Hoy domingo tenemos un menú especial. Reserva o pide por WhatsApp.');
          setText('menu-hoy-title', 'Resumen del domingo');
          setText('menudiario-caption', 'Afiche del domingo especial');

          // Usamos primera fila como “resumen”
          const first = rows[0] || {};
          setText('menu-precio', normalizePrice(first.price) || '$2.75');
          setText('menu-sopa', (first.sopa || 'Consulta por WhatsApp').toString().trim());
          setText('menu-segundos', (first.plato_fuerte || 'Opciones disponibles').toString().trim());
          setText('menu-bebida', (first.bebida || 'Limonada').toString().trim() || 'Limonada');

          setImg('menu-hoy-poster', first.poster_url, today, 'img/menu_default.jpg');

          // Opciones del domingo (grid)
          const cont = document.getElementById('especial-opciones');
          if (cont) {
            cont.innerHTML = rows.map((r, idx) => {
              const title = (r.title || ('Opción ' + (idx + 1))).toString().trim();
              const price = normalizePrice(r.price) || '$2.75';
              return `
                <div class="menu-hoy-col">
                  <h3>${title}</h3>
                  <p><strong>Sopa:</strong> ${(r.sopa || '').toString().trim()}</p>
                  <p><strong>Plato fuerte:</strong> ${(r.plato_fuerte || '').toString().trim()}</p>
                  <p><strong>Bebida:</strong> ${(r.bebida || '').toString().trim()}</p>
                  <div class="price">${price}</div>
                </div>
              `;
            }).join('');
          }

          const waBtn = document.querySelector('#menu-hoy a.btn.btn-primary');
          if (waBtn) waBtn.href = waLink('Hola, vengo del menú especial de domingo de Floresta Brava. Quiero pedir: ');

          const wa2 = document.getElementById('especial-wa');
          if (wa2) wa2.href = waLink('Hola, vengo del menú especial de domingo de Floresta Brava. Quiero reservar/pedir: ');

          if (especialBox) especialBox.style.display = '';
        } catch (e) {
          console.warn('DOMINGO_ESPECIAL:', e);
          await applyDaily();
        }
      }

      if (isSunday()) {
        await applySundaySpecial();
      } else {
        await applyDaily();
      }
    })();
  </script>
</body>
</html>
