<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Floresta Brava | Comida típica ecuatoriana en Quito</title>
  <meta name="description" content="Floresta Brava: comida típica ecuatoriana en Quito. Menú diario, platos estrella y menú especial los domingos. Pide por WhatsApp." />

  <!-- Preconnect -->
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

  <!-- PapaParse para CSV -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js" defer></script>

  <style>
    :root {
      --madera: #7a4b1f;
      --madera-oscura: #4b2a12;
      --turquesa: #1fb6c9;
      --naranja: #f57c22;
      --crema: #fff7e8;
      --gris: #444;
      --verde: #145b6b;
      --verde-oscuro: #0b2731;
      --amarillo: var(--naranja);
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; line-height: 1.5; color: #222; background: #f5f3ee; }
    a { text-decoration: none; }

    header {
      position: sticky; top: 0; z-index: 100;
      background: linear-gradient(90deg, var(--madera-oscura), var(--verde));
      backdrop-filter: blur(6px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.25);
    }
    .container { max-width: 1120px; margin: 0 auto; padding: 0 16px; }
    .nav { display: flex; align-items: center; justify-content: space-between; height: 68px; }
    .logo-area { display: flex; align-items: center; gap: 10px; }
    .logo-img { height: 40px; width: auto; }
    nav ul { list-style: none; display: flex; gap: 16px; }
    nav a { color: #f4f4f4; font-size: 14px; }
    nav a:hover { color: var(--amarillo); }

    /* Los bloques dinámicos inician ocultos; el contenedor del menú diario siempre visible */
    #menu-hoy, #menu-especial, #menu-especial-opciones { display: none; }

    .hero {
      position: relative; min-height: 80vh;
      display: flex; align-items: center;
      color: #fff; background: #000; overflow: hidden;
    }
    .hero::before {
      content: ""; position: absolute; inset: 0;
      background: linear-gradient(120deg, rgba(10,39,49,0.95), rgba(122,75,31,0.65));
      z-index: 1;
    }
    .hero img.bg {
      position: absolute; inset: 0;
      width: 100%; height: 100%;
      object-fit: cover;
      filter: brightness(.8);
    }
    .hero-content { position: relative; z-index: 2; padding: 40px 16px 40px; }
    .hero-kicker { font-size: 13px; letter-spacing: .18em; text-transform: uppercase; color: #ffe6c0; margin-bottom: 8px; }
    .hero h1 { font-size: 32px; max-width: 520px; margin-bottom: 12px; }
    .hero p { max-width: 480px; font-size: 15px; color: #fbeee0; margin-bottom: 20px; }
    .hero-badges { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 24px; font-size: 12px; }

    .badge {
      padding: 4px 10px; border-radius: 999px;
      background: rgba(0,0,0,0.25);
      border: 1px solid rgba(255,255,255,0.3);
      color: #fff;
    }
    .btn {
      display: inline-flex; align-items: center; justify-content: center;
      padding: 12px 22px; border-radius: 999px;
      font-weight: 600; font-size: 14px;
      border: none; cursor: pointer;
      transition: transform .1s ease, box-shadow .15s ease, background .15s ease;
    }
    .btn-primary { background: #22c15d; color: #fff; box-shadow: 0 10px 20px rgba(0,0,0,0.35); }
    .btn-primary:hover { transform: translateY(-1px); box-shadow: 0 14px 26px rgba(0,0,0,0.4); background: #1ea652; }
    .btn-ghost { background: transparent; color: #fff; border: 1px solid rgba(255,255,255,0.7); margin-left: 10px; }
    .btn-group { display: flex; flex-wrap: wrap; gap: 8px; }

    .section { padding: 56px 0; }
    .section.alt { background: #ffffff; }
    .section.soft { background: var(--crema); }
    .section-title { font-size: 24px; text-align: center; margin-bottom: 8px; color: var(--madera-oscura); }
    .section-subtitle { font-size: 14px; text-align: center; max-width: 560px; margin: 0 auto 28px; color: #555; }
    .grid { display: grid; gap: 16px; }

    .hero-logo { margin-bottom: 24px; text-align: center; }
    .hero-logo img { height: 180px; width: auto; filter: drop-shadow(0 10px 18px rgba(0,0,0,0.55)); }

    @media (min-width: 768px) {
      .hero-logo img { height: 240px; }
      .hero h1 { font-size: 40px; }
      .grid-3 { grid-template-columns: repeat(3, 1fr); }
      .grid-2 { grid-template-columns: repeat(2, 1fr); }
      .hero-content { padding-top: 56px; }
    }

    .card {
      background: #fff; border-radius: 14px; padding: 16px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.06);
      border: 1px solid rgba(0,0,0,0.03);
    }
    .card img { width: 100%; border-radius: 12px; margin-bottom: 10px; display: block; }
    .card h3 { font-size: 16px; margin-bottom: 4px; color: var(--madera-oscura); }
    .card p { font-size: 13px; color: #555; }
    .price { font-weight: 700; color: var(--verde-oscuro); margin-top: 6px; font-size: 14px; }
    .pill { display: inline-block; font-size: 11px; padding: 3px 8px; border-radius: 999px; background: rgba(31,182,201,0.09); color: var(--verde-oscuro); margin-top: 4px; }

    .highlight {
      background: #fff; border-radius: 14px; padding: 16px;
      border-left: 4px solid var(--madera);
      box-shadow: 0 6px 18px rgba(0,0,0,0.04);
      margin-bottom: 16px;
    }
    .highlight h3 { font-size: 16px; margin-bottom: 4px; color: var(--madera-oscura); }
    .highlight p { font-size: 13px; color: #555; }

    .map { border-radius: 16px; overflow: hidden; box-shadow: 0 8px 22px rgba(0,0,0,0.09); }
    .map iframe { width: 100%; height: 320px; border: 0; }

    .section-menudiario .menudiario-top {
      display: grid;
      grid-template-columns: minmax(0, 1.2fr) minmax(0, 1fr);
      max-width: 900px;
      margin: 24px auto 0;
      align-items: flex-start;
      gap: 40px;
    }
    .menudiario-img { margin-top: 8px; }
    .menudiario-img img{
      width: 100%;
      max-width: 420px;
      height: auto;
      display: block;
      margin-left: auto;
      object-fit: contain;     /* no recorta */
      object-position: center;
    }
    .menudiario-caption { font-size: 12px; color: #777; margin-top: 6px; text-align: right; }
    .menudiario-horario { max-width: 900px; margin: 32px auto 0; font-size: 14px; color: #555; }
    .menudiario-horario h3 { font-size: 16px; margin-bottom: 6px; color: var(--madera-oscura); }
    .menudiario-horario ul { margin-left: 18px; margin-bottom: 8px; }

    @media (max-width: 767px) {
      .section-menudiario .menudiario-top { max-width: 100%; margin-top: 16px; gap: 20px; grid-template-columns: 1fr; }
      .menudiario-img img { max-width: 100%; margin-left: 0; }
      .menudiario-caption { text-align: left; }
    }

    footer {
      background: var(--madera-oscura);
      color: #eee;
      padding: 24px 0;
      font-size: 13px;
      border-top: 3px solid var(--naranja);
    }
    .footer-inner { display: flex; flex-direction: column; gap: 8px; }
    .social a { color: #eee; margin-right: 12px; }
    .social a:hover { color: var(--turquesa); }
    @media (min-width: 640px) {
      .footer-inner { flex-direction: row; justify-content: space-between; align-items: center; }
    }

    .skip-link {
      position: absolute; left: -999px; top: 8px;
      background: #fff; color: #000;
      padding: 10px 14px; border-radius: 10px;
      z-index: 9999; box-shadow: 0 6px 18px rgba(0,0,0,.2);
    }
    .skip-link:focus { left: 12px; }

    .nav-toggle {
      display: none;
      align-items: center; justify-content: center; gap: 6px;
      background: rgba(255,255,255,.12);
      border: 1px solid rgba(255,255,255,.18);
      border-radius: 14px; padding: 10px 12px;
      cursor: pointer; color: #fff;
      backdrop-filter: blur(6px);
    }
    .nav-toggle:focus { outline: 2px solid rgba(255,255,255,.5); outline-offset: 2px; }
    .nav-toggle-bar { display: block; width: 22px; height: 2px; background: #fff; border-radius: 2px; }
    .nav-menu ul { margin: 0; padding: 0; list-style: none; }

    @media (max-width: 768px) {
      .nav-toggle { display: inline-flex; }
      .nav-menu ul {
        display: none;
        position: absolute;
        right: 16px;
        top: 64px;
        width: min(320px, calc(100vw - 32px));
        background: rgba(10,10,10,.88);
        border: 1px solid rgba(255,255,255,.14);
        border-radius: 16px;
        padding: 10px;
        box-shadow: 0 18px 40px rgba(0,0,0,.35);
        backdrop-filter: blur(10px);
      }
      .nav-menu.open ul { display: block; }
      .nav-menu li a { display: block; padding: 12px 14px; border-radius: 12px; }
      .nav-menu li a:hover { background: rgba(255,255,255,.10); }
    }

    .floating-ctas {
      position: fixed;
      right: 16px;
      bottom: 16px;
      display: grid;
      gap: 10px;
      z-index: 999;
    }
    .fab {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 12px 14px;
      border-radius: 999px;
      color: #fff;
      font-weight: 700;
      box-shadow: 0 14px 30px rgba(0,0,0,.25);
      border: 1px solid rgba(255,255,255,.14);
      backdrop-filter: blur(10px);
    }
    .fab svg { width: 20px; height: 20px; fill: currentColor; }
    .fab-whatsapp { background: #1faa59; }
    .fab-maps { background: rgba(0,0,0,.55); }
    @media (max-width: 480px) {
      .fab span { display: none; }
      .fab { padding: 12px; border-radius: 16px; }
    }

    .menu-hoy-grid{
      display:grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap:16px;
      margin-top:18px;
    }
    .menu-hoy-col{
      background:#fff;
      border:1px solid rgba(0,0,0,.06);
      border-radius:16px;
      padding:16px 16px 14px;
      box-shadow:0 10px 30px rgba(0,0,0,.06);
      text-align:center;
    }
    .menu-hoy-col h3{ margin:0 0 10px 0; }
    @media (max-width: 920px){ .menu-hoy-grid{ grid-template-columns: 1fr; } }

    #platos{ padding-top: 18px; }

    .finsemana-banner{
      margin: 18px auto 10px;
      max-width: 980px;
      border-radius: 18px;
      overflow: hidden;
      box-shadow: 0 14px 40px rgba(0,0,0,.10);
      border: 1px solid rgba(0,0,0,.06);
      background: #fff;
    }
    .finsemana-banner img{
      width: 100%;
      height: auto;
      display: block;
      max-height: 520px;
      object-fit: cover;
      object-position: center;
    }
    @media (max-width: 640px){ .finsemana-banner img{ max-height: 340px; } }

    .finsemana-opciones { grid-template-columns: repeat(2, minmax(0, 1fr)); max-width: 860px; margin-left: auto; margin-right: auto; }
    @media (max-width: 920px){ .finsemana-opciones{ grid-template-columns: 1fr; } }
  </style>
</head>

<body>
  <a class="skip-link" href="#contenido">Saltar al contenido</a>

  <header>
    <div class="container">
      <div class="nav">
        <a class="logo-area" href="#inicio" aria-label="Floresta Brava">
          <img class="logo-img" src="assets/logo.png" alt="Floresta Brava" loading="eager" decoding="async">
          <strong style="color:#fff; letter-spacing:.08em;">FLORESTA BRAVA</strong>
        </a>

        <button class="nav-toggle" id="navToggle" aria-expanded="false" aria-controls="navMenu">
          <span class="nav-toggle-bar"></span>
          <span class="nav-toggle-bar"></span>
          <span class="nav-toggle-bar"></span>
        </button>

        <nav class="nav-menu" id="navMenu">
          <ul>
            <li><a href="#inicio">Menú</a></li>
            <li><a href="#platos">Platos estrella</a></li>
            <li><a href="#menudiario">Menú diario</a></li>
            <li><a href="#menudiario">Fin de semana</a></li>
            <li><a href="#empresas">Empresas</a></li>
            <li><a href="#ubicacion">Ubicación</a></li>
            <li><a href="#resenas">Reseñas</a></li>
            <li><a href="#faq">FAQ</a></li>
            <li><a href="#contacto">Contacto</a></li>
          </ul>
        </nav>
      </div>
    </div>
  </header>

  <main id="contenido">
    <!-- HERO -->
    <section class="hero" id="inicio">
      <img class="bg" src="assets/hero.jpg" alt="Comida típica ecuatoriana" loading="eager" decoding="async">
      <div class="container hero-content">
        <div class="hero-logo">
          <img src="assets/logo-grande.png" alt="Floresta Brava" loading="eager" decoding="async">
        </div>

        <div class="hero-kicker">Comida típica ecuatoriana</div>
        <h1>La excelencia del sabor, todos los días en Quito</h1>
        <p>
          Menú diario (lunes a sábado) y menú especial los domingos. Pide por WhatsApp o visítanos en Av. Coruña y Guipúzcoa.
        </p>

        <div class="hero-badges">
          <span class="badge">Menú diario</span>
          <span class="badge">Domingo especial</span>
          <span class="badge">Pedidos por WhatsApp</span>
        </div>

        <div class="btn-group">
          <a class="btn btn-primary" href="https://wa.me/593983603626?text=Hola%2C%20vengo%20de%20Floresta%20Brava.%20Quiero%20hacer%20un%20pedido%3A" target="_blank" rel="noopener">Pedir por WhatsApp</a>
          <a class="btn btn-ghost" href="#menudiario">Ver menú</a>
        </div>
      </div>
    </section>

    <!-- PLATOS -->
    <section id="platos" class="section alt">
      <div class="container">
        <h2 class="section-title">Platos estrella</h2>
        <p class="section-subtitle">Algunos favoritos de nuestros clientes.</p>

        <div class="grid grid-3">
          <article class="card">
            <img src="assets/plato1.jpg" alt="Plato estrella 1" loading="lazy" decoding="async">
            <h3>Plato estrella 1</h3>
            <p>Descripción breve del plato.</p>
            <div class="price">$2.50</div>
          </article>

          <article class="card">
            <img src="assets/plato2.jpg" alt="Plato estrella 2" loading="lazy" decoding="async">
            <h3>Plato estrella 2</h3>
            <p>Descripción breve del plato.</p>
            <div class="price">$1.50</div>
          </article>

          <article class="card">
            <img src="assets/plato3.jpg" alt="Plato estrella 3" loading="lazy" decoding="async">
            <h3>Plato estrella 3</h3>
            <p>Descripción breve del plato.</p>
            <div class="price">$2.75</div>
          </article>
        </div>
      </div>
    </section>

    <!-- MENU DIARIO / DOMINGO ESPECIAL (UN SOLO BLOQUE) -->
    <section id="menudiario" class="section soft section-menudiario">
      <div class="container">
        <h2 class="section-title" id="menudiario-title">Menú diario</h2>
        <p class="section-subtitle" id="menudiario-subtitle">Todos los días tenemos un menú diferente con sopa, plato fuerte y bebida. Ideal para almuerzos ejecutivos y en familia.</p>

        <div class="menudiario-top">
          <div>
            <div class="highlight">
              <h3>Desayunos típicos</h3>
              <p>Bolón, tigrillo, tamales, corviches, desayunos continentales, desayunos costeños, café pasado y más opciones para empezar bien la mañana.</p>
            </div>

            <div class="highlight">
              <h3>Almuerzo ejecutivo</h3>
              <p>Sopa del día, plato fuerte a elegir y jugo natural.</p>
            </div>

            <!-- Lunes a sábado: MENÚ DE HOY -->
            <div id="menu-hoy" class="highlight">
              <h3>Menú de hoy</h3>
              <p><strong>Sopa:</strong> <span id="menu-sopa">Consulta por WhatsApp</span></p>
              <p><strong>Segundos:</strong> <span id="menu-segundos">3 opciones disponibles</span></p>
              <p><strong>Precio:</strong> <span id="menu-precio">$2.75</span></p>
              <p><strong>Bebida:</strong> <span id="menu-bebida">Limonada</span></p>

              <a class="btn btn-primary" href="https://wa.me/593983603626?text=Hola%2C%20vengo%20del%20men%C3%BA%20de%20hoy%20de%20Floresta%20Brava.%20Quiero%20pedir%3A" target="_blank" rel="noopener">Pedir menú de hoy</a>
            </div>

            <!-- Domingo: MENÚ ESPECIAL (mismo bloque/posición) -->
            <div id="menu-especial" class="highlight">
              <h3>Menú especial (Domingo)</h3>
              <p>Hoy tenemos opciones especiales. Reserva por WhatsApp para que lo tengas listo.</p>
              <a class="btn btn-primary" href="https://wa.me/593983603626?text=Hola%2C%20vengo%20del%20men%C3%BA%20especial%20de%20domingo%20de%20Floresta%20Brava.%20Quiero%20reservar%3A" target="_blank" rel="noopener">Reservar por WhatsApp</a>
            </div>
          </div>

          <div class="menudiario-img">
            <div class="finsemana-banner">
              <img id="menu-poster" src="" alt="Afiche del menú" loading="lazy" decoding="async">
            </div>
            <div class="menudiario-caption">Imagen referencial del menú del día.</div>
          </div>
        </div>

        <!-- Opciones solo cuando es domingo y el CSV está activo -->
        <div id="menu-especial-opciones" class="menu-hoy-grid finsemana-opciones" style="display:none"></div>

        <div class="menudiario-horario">
          <h3>Horarios</h3>
          <ul>
            <li><strong>Lunes a sábado:</strong> menú diario</li>
            <li><strong>Domingo:</strong> menú especial</li>
          </ul>
          <p>Para pedidos y reservas, contáctanos por WhatsApp.</p>
        </div>
      </div>
    </section>

    <!-- EMPRESAS -->
    <section id="empresas" class="section alt">
      <div class="container">
        <h2 class="section-title">Empresas</h2>
        <p class="section-subtitle">Atendemos pedidos corporativos y eventos.</p>
        <div class="grid grid-2">
          <div class="card">
            <h3>Pedidos programados</h3>
            <p>Coordina tu menú para tu equipo.</p>
          </div>
          <div class="card">
            <h3>Eventos</h3>
            <p>Cotiza con nosotros por WhatsApp.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- UBICACION -->
    <section id="ubicacion" class="section soft">
      <div class="container">
        <h2 class="section-title">Ubicación</h2>
        <p class="section-subtitle">Av. Coruña y Guipúzcoa, Quito.</p>

        <div class="map">
          <iframe
            title="Mapa Floresta Brava"
            loading="lazy"
            referrerpolicy="no-referrer-when-downgrade"
            src="https://www.google.com/maps?q=Av.%20Coru%C3%B1a%20y%20Guip%C3%BAzcoa%20Quito&output=embed">
          </iframe>
        </div>
      </div>
    </section>

    <!-- RESEÑAS -->
    <section id="resenas" class="section alt">
      <div class="container">
        <h2 class="section-title">Reseñas</h2>
        <p class="section-subtitle">Lo que dicen nuestros clientes.</p>
        <div class="grid grid-3">
          <div class="card"><p>“Muy rico y buen precio.”</p><div class="pill">Cliente</div></div>
          <div class="card"><p>“Excelente atención.”</p><div class="pill">Cliente</div></div>
          <div class="card"><p>“Volveré pronto.”</p><div class="pill">Cliente</div></div>
        </div>
      </div>
    </section>

    <!-- FAQ -->
    <section id="faq" class="section soft">
      <div class="container">
        <h2 class="section-title">FAQ</h2>
        <p class="section-subtitle">Preguntas frecuentes.</p>
        <div class="grid grid-2">
          <div class="card">
            <h3>¿Cómo pido?</h3>
            <p>Escríbenos por WhatsApp y te atendemos.</p>
          </div>
          <div class="card">
            <h3>¿Hay menú especial?</h3>
            <p>Sí, solo los domingos, según el afiche publicado.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- CONTACTO -->
    <section id="contacto" class="section alt">
      <div class="container">
        <h2 class="section-title">Contacto</h2>
        <p class="section-subtitle">Pide o reserva por WhatsApp.</p>
        <div class="btn-group" style="justify-content:center;">
          <a class="btn btn-primary" href="https://wa.me/593983603626?text=Hola%2C%20vengo%20de%20Floresta%20Brava.%20Quiero%20hacer%20un%20pedido%3A" target="_blank" rel="noopener">WhatsApp</a>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <div class="container footer-inner">
      <div>© <span id="year"></span> Floresta Brava</div>
      <div class="social">
        <a href="#" aria-label="Instagram">Instagram</a>
        <a href="#" aria-label="Facebook">Facebook</a>
        <a href="#" aria-label="TikTok">TikTok</a>
      </div>
    </div>
  </footer>

  <!-- Floating CTAs -->
  <div class="floating-ctas" aria-label="Acciones rápidas">
    <a class="fab fab-whatsapp" href="https://wa.me/593983603626?text=Hola%2C%20vengo%20de%20Floresta%20Brava.%20Quiero%20hacer%20un%20pedido%3A" target="_blank" rel="noopener" aria-label="Pedir por WhatsApp">
      <svg viewBox="0 0 32 32" aria-hidden="true"><path d="M19.11 17.44c-.27-.14-1.6-.79-1.85-.88-.25-.09-.43-.14-.61.14-.18.27-.7.88-.86 1.06-.16.18-.32.2-.59.07-.27-.14-1.15-.42-2.2-1.34-.81-.72-1.36-1.6-1.52-1.87-.16-.27-.02-.42.12-.56.12-.12.27-.32.41-.48.14-.16.18-.27.27-.45.09-.18.05-.34-.02-.48-.07-.14-.61-1.47-.84-2.01-.22-.53-.45-.46-.61-.47l-.52-.01c-.18 0-.48.07-.73.34-.25.27-.95.93-.95 2.27 0 1.34.97 2.64 1.11 2.82.14.18 1.91 2.91 4.63 4.08.65.28 1.15.45 1.54.58.65.21 1.24.18 1.7.11.52-.08 1.6-.65 1.83-1.28.23-.63.23-1.17.16-1.28-.07-.11-.25-.18-.52-.32zM16.03 3C9.38 3 4 8.38 4 15.03c0 2.33.66 4.5 1.8 6.33L4 29l7.79-1.75c1.75.95 3.75 1.49 5.88 1.49C24.62 28.74 30 23.36 30 16.71 30 10.06 22.68 3 16.03 3zm0 23.07c-2.02 0-3.9-.58-5.49-1.58l-.39-.24-4.62 1.04.99-4.5-.25-.41a9.92 9.92 0 0 1-1.57-5.35c0-5.5 4.47-9.97 9.97-9.97s9.97 4.47 9.97 9.97-4.47 10.04-9.97 10.04z"/></svg>
      <span>Pedir</span>
    </a>

    <a class="fab fab-maps" href="#ubicacion" aria-label="Ver ubicación">
      <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 2C8.69 2 6 4.69 6 8c0 4.5 6 14 6 14s6-9.5 6-14c0-3.31-2.69-6-6-6zm0 8.5c-1.38 0-2.5-1.12-2.5-2.5S10.62 5.5 12 5.5s2.5 1.12 2.5 2.5S13.38 10.5 12 10.5z"/></svg>
      <span>Ubicación</span>
    </a>
  </div>

  <!-- JS (defer) -->
  <script defer>
    // ==============================
    // Config
    // ==============================
    const MENU_HOY_CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRYEmb5kfi089waViF4yNTGsSyeQYKDO-KFyuHBZGMXjxjB2fs38FWdHne6387SjEVs9HQq2qJPdh4A/pub?gid=0&single=true&output=csv";
    const FIN_SEMANA_CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRYEmb5kfi089waViF4yNTGsSyeQYKDO-KFyuHBZGMXjxjB2fs38FWdHne6387SjEVs9HQq2qJPdh4A/pub?gid=1588540198&single=true&output=csv";

    const TZ_EC = "America/Guayaquil";
    const WHATSAPP_BASE = "https://wa.me/593983603626?text=";

    // ==============================
    // Helpers
    // ==============================
    function setText(id, value) {
      const el = document.getElementById(id);
      if (el) el.textContent = value;
    }

    function setHtml(id, html) {
      const el = document.getElementById(id);
      if (el) el.innerHTML = html;
    }

    function show(id, display = "") {
      const el = document.getElementById(id);
      if (el) el.style.display = display;
    }

    function hide(id) {
      const el = document.getElementById(id);
      if (el) el.style.display = "none";
    }

    function normalizePrice(p) {
      const s = (p ?? "").toString().trim();
      if (!s) return "";
      return s.startsWith("$") ? s : "$" + s;
    }

    function getNowInTZ(tz) {
      return new Date(new Date().toLocaleString("en-US", { timeZone: tz }));
    }

    function todayYMD(tz) {
      const d = getNowInTZ(tz);
      const y = d.getFullYear();
      const m = String(d.getMonth() + 1).padStart(2, "0");
      const day = String(d.getDate()).padStart(2, "0");
      return `${y}-${m}-${day}`;
    }

    function dayOfWeekTZ(tz) {
      return getNowInTZ(tz).getDay(); // 0=Dom, 1=Lun...
    }

    function inRange(today, from, to) {
      // compara YYYY-MM-DD
      return today >= from && today <= to;
    }

    function loadCSV(url) {
      return new Promise((resolve, reject) => {
        if (!window.Papa) {
          reject(new Error("PapaParse no está cargado"));
          return;
        }
        Papa.parse(url, {
          download: true,
          header: true,
          skipEmptyLines: true,
          complete: (results) => resolve((results.data || []).filter(Boolean)),
          error: (err) => reject(err)
        });
      });
    }

    function setPosterImg(imgId, url) {
      const img = document.getElementById(imgId);
      if (!img) return;

      const clean = (url || "").toString().trim();
      if (!clean) {
        // Fallback local (ajusta si quieres otro default)
        img.src = "assets/menu-default.png";
        return;
      }
      img.src = clean;
    }

    function waHref(message) {
      return WHATSAPP_BASE + encodeURIComponent(message);
    }

    // ==============================
    // Main logic (un solo bloque)
    // - Lunes a sábado: muestra MENU HOY
    // - Domingo: si hay FIN DE SEMANA activo, muestra MENU ESPECIAL
    // ==============================
    async function initMenus() {
      const today = todayYMD(TZ_EC);
      const dow = dayOfWeekTZ(TZ_EC); // 0 domingo
      const isSunday = dow === 0;

      // Footer year
      const yearEl = document.getElementById("year");
      if (yearEl) yearEl.textContent = new Date().getFullYear();

      // Por defecto: ocultar ambos bloques (se habilita el que corresponda)
      hide("menu-hoy");
      hide("menu-especial");
      hide("menu-especial-opciones");

      // Intentar cargar fin de semana para decidir si aplica (solo domingo)
      let finRows = [];
      try {
        finRows = await loadCSV(FIN_SEMANA_CSV_URL);
      } catch (e) {
        console.warn("FIN_SEMANA CSV:", e);
      }

      const finActive =
        isSunday &&
        finRows.length &&
        (finRows[0].active_from || "").toString().trim() &&
        (finRows[0].active_to || "").toString().trim() &&
        inRange(today, finRows[0].active_from.trim(), finRows[0].active_to.trim());

      if (finActive) {
        // =========================
        // DOMINGO ESPECIAL
        // =========================
        setText("menudiario-title", "Menú especial (Domingo)");
        setText("menudiario-subtitle", "Hoy tenemos opciones especiales. Reserva por WhatsApp para que lo tengas listo.");

        show("menu-especial", "");
        const btn = document.querySelector("#menu-especial a.btn.btn-primary");
        if (btn) btn.href = waHref("Hola, vengo del menú especial de domingo de Floresta Brava. Quiero reservar: ");

        // Poster (toma el del primer registro)
        setPosterImg("menu-poster", finRows[0].poster_url);

        // Opciones
        const optionsHtml = finRows.map((r, idx) => {
          const title = (r.title || ("Opción " + (idx + 1))).toString().trim();
          const price = normalizePrice(r.price) || "$2.75";
          return `
            <div class="menu-hoy-col">
              <h3>${title}</h3>
              <p><strong>Sopa:</strong> ${(r.sopa || "").toString().trim()}</p>
              <p><strong>Plato fuerte:</strong> ${(r.plato_fuerte || "").toString().trim()}</p>
              <p><strong>Bebida:</strong> ${(r.bebida || "").toString().trim()}</p>
              <div class="price">${price}</div>
            </div>
          `;
        }).join("");

        setHtml("menu-especial-opciones", optionsHtml);
        show("menu-especial-opciones", "grid");

        return; // no mostrar menú diario hoy
      }

      // ===========================
      // LUNES A SABADO (MENU HOY)
      // ===========================
      setText("menudiario-title", "Menú diario");
      setText("menudiario-subtitle", "Todos los días tenemos un menú diferente con sopa, plato fuerte y bebida. Ideal para almuerzos ejecutivos y en familia.");

      let hoyRows = [];
      try {
        hoyRows = await loadCSV(MENU_HOY_CSV_URL);
      } catch (e) {
        console.warn("MENU_HOY CSV:", e);
      }

      if (hoyRows.length) {
        const m = hoyRows[0] || {};
        setText("menu-precio", normalizePrice(m.price) || "$2.75");

        const sopas = (m.sopas || "").toString().split("|").map(s => s.trim()).filter(Boolean);
        const platos = (m.platos_fuertes || "").toString().split("|").map(s => s.trim()).filter(Boolean);

        setText("menu-sopa", sopas.length ? sopas.join(" / ") : "Consulta por WhatsApp");
        setText("menu-segundos", platos.length ? platos.join(" / ") : "3 opciones disponibles");
        setText("menu-bebida", (m.bebida || "Limonada").toString().trim());

        setPosterImg("menu-poster", m.poster_url);

        const waBtn = document.querySelector('#menu-hoy a.btn.btn-primary');
        if (waBtn) waBtn.href = waHref("Hola, vengo del menú de hoy de Floresta Brava. Quiero pedir: ");

        show("menu-hoy", "");
      } else {
        // Fallback sin CSV
        setPosterImg("menu-poster", "");
        show("menu-hoy", "");
      }
    }

    // Mobile nav
    function initNav() {
      const btn = document.getElementById("navToggle");
      const nav = document.getElementById("navMenu");
      if (!btn || !nav) return;

      btn.addEventListener("click", () => {
        const open = nav.classList.toggle("open");
        btn.setAttribute("aria-expanded", open ? "true" : "false");
      });

      // Cierra al hacer click en un enlace (mobile)
      nav.querySelectorAll("a").forEach(a => {
        a.addEventListener("click", () => {
          nav.classList.remove("open");
          btn.setAttribute("aria-expanded", "false");
        });
      });
    }

    document.addEventListener("DOMContentLoaded", () => {
      initNav();
      initMenus();
    });
  </script>
</body>
</html>
